<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			*{
				padding: 0;
				margin: 0;
				
			}
			body{
				background: pink;
			}
			.box{
				width: 400px;
				height: 600px;
				margin: 150px auto;
                border: 1px solid #000000;
			}
			.box a img{
				width: 113px;
				height: 150px;
				margin-left: 150px;
			}
			.phone{
				width: 300px;
				height: 50px;
				border: none;
				border-bottom: 1.5px solid #000;
				margin-left: 30px;
				font-size: 18px;
				text-indent: 4em;
				outline: none;
				background: url(img/23670.png) no-repeat -13px -15px;
			}
			.kuang{
				width: 400px;
				height: auto;
				height: 600px;
				/*background: pink;*/
				margin-top: 70px;
			}
			.YanZhang{
				outline: none;
				width: 150px;
				height: 55px;
				margin: 40px 40px;
				border: none;
				border-bottom: 1.5px solid #000;
				text-indent: 3em;
				font-size: 16px;
				background: url(img/23671.png)no-repeat -17px -14px;
			}
			.get{
				width: 130px;
				height: 40px;
				font-size: 16px;
				border-radius: 10px;
			}
			.op{
				width: 80px;
				margin: -40px 250px;
				height: 30px;
				position: absolute;
				border: 1px solid #000000;
			}
			.btn{
				width: 300px;
				height: 50px;
				margin-top: 20px;
				margin-left: 60px;
				background: #000;
				color: white;
				border-radius: 10px;
				font-size: 18px;
			}
		</style>
	</head>
	<body>
		<div class="box">
			<a href="#"><img src="img/nlicon.png"/></a><br />
			<div class="kuang">
			<input  type="text" id="phone" class="phone" placeholder="输入手机号码"/>
			<input  type="password" id="pass" class="phone" placeholder="输入密码" style="margin-top: 30px;"/>
			<br />
			<input type="text" id="YanZhang" class="YanZhang" placeholder="输入验证码" />
			<input type="button" id="get" class="get" value="获取验证码"/>
			<p id="op" class="op" ></p>
			<p><input type="checkbox" id="ck" style=" margin: -20px 20px;"/>同意协议</p>
			<input type="button"  id="btn" class="btn" value="登录" />
			</div>
		</div>
		<script type="text/javascript">
			var phone=document.getElementById("phone");
			var pass=document.getElementById("pass");
			var yanZ=document.getElementById("YanZhang");
			var get=document.getElementById("get");
			var op=document.getElementById("op");
			var btn=document.getElementById("btn");
			get.onclick=function(){
						var	p=parseInt(Math.random()*1000);
						 op.innerHTML=p;
						 console.log(p);
						}
			
			btn.onclick=function(){
				var pho=phone.value;
				var reg=/^1[35678]\d{9}$/;
				if(yanZ.value== op.innerHTML){
						if(reg.test(pho)){
							console.log("验证码正确");
						var xhr=new XMLHttpRequest();
						xhr.onreadystatechange=function(){
							if(xhr.readyState==4){
								var obj = JSON.parse(xhr.responseText);
								console.log(obj);
									console.log(obj.code);
								if(obj.code == 0){
									console.log(obj.code);
									alert("注册成功");
									window.location.href = "./login.html";
								}else{
									alert(obj.message+"注册失败");
									
								}
							}
						}
						xhr.open("post","http://h6.duchengjiu.top/shop/api_user.php 

",true);
						xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
						xhr.send("status=register"+"&username="+pho+"&password="+pass.value);
					}else{
						alert("手机号格式错误");
					}
					
				}else{
					console.log("验证码bu正确");
						
				}
				
			}
			
		</script>
	</body>
</html>
